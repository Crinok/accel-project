
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Accelerometer Project</title>
<meta name="viewport" content="width=device-width,user-scalable=no" />
<style>
*{
	margin:0; padding: 0;
}
body {
	background: #00bb72; font-family: helvetica, arial, sans serif;
}

</style>
</head>

<body>

<div id="content">

</div>

<script type="text/javascript">
var x = document.documentElement.clientWidth / 2, y = document.documentElement.clientHeight / 2;
var vx = 0, vy = 0,
	ax = 0, ay = 0;
var acceleration = 7;
var bounciness = 8;
var frameRate = 25;
var gravity = 0.97;

var canvas = document.createElement('canvas');
	canvas.id = "cnvs";
	canvas.width = document.documentElement.clientWidth;
	canvas.height = document.documentElement.clientHeight;

var content = document.getElementById("content");
	content.appendChild(canvas);

var context = canvas.getContext("2d");

if (window.DeviceMotionEvent != undefined) {
	window.ondevicemotion = function(e) {
		ax = event.accelerationIncludingGravity.x * - acceleration;
		ay = event.accelerationIncludingGravity.y * - acceleration;
	}

	setInterval( function() {
		var landscapeOrientation = window.innerWidth/window.innerHeight > 1;
		if (landscapeOrientation) {
			vx = vx + ay;
			vy = vy + ax;
		} else {
			vy = vy - ay;
			vx = vx + ax;
		}

		vx = vx * gravity;
		vy = vy * gravity;
		y = parseInt(y + vy / 50);
		x = parseInt(x + vx / 50);
		
		boundingBoxCheck();
		init();
		circle2.update();
		circle1.update();
		
		
	}, frameRate);
} 


var circle1, circle2;

function init(){
	context.clearRect(0, 0, canvas.width, canvas.height);
	circle2 = new Circle(canvas.width / 2, canvas.height / 2, 50, "red");
	circle1 = new Circle(x, y, 10, "white");
	
	//Big Circle
	// context.beginPath();
	// context.arc(canvas.width / 2, canvas.height / 2, 50, 0, Math.PI * 2, false);
	// context.fillStyle = 'red';
	// context.fill();
	// context.lineWidth = 1;
	// context.strokeStyle = 'red';
	// context.stroke();
	// context.closePath();

	// //Small circle
	// context.beginPath();
	// context.arc(x, y, 10, 0, Math.PI * 2, false);
	// context.fillStyle = 'white';
	// context.fill();
	// context.lineWidth = 1;
	// context.strokeStyle = 'white';
	// context.stroke();
	// context.closePath();
}

function Circle(posX, posY, radius, color){
	this.posX = posX;
	this.posY = posY;
	this.radius = radius;
	this.color = color;

	this.update = function(){
		this.draw();
	};

	this.draw = function(){
		context.beginPath();
		context.arc(this.posX, this.posY, this.radius, 0, Math.PI * 2, false);
		context.fillStyle = this.color;
		context.fill();
		context.lineWidth = 1;
		context.strokeStyle = this.color;
		context.stroke();
		context.closePath();
	};
}

function boundingBoxCheck(){
	if (x < 20) {
		x = 20;
		vx = -vx / bounciness; 
	}

	if (y < 20) {
		y = 20;
		vy = -vy / bounciness; 
	}

	if (x > document.documentElement.clientWidth-20) {
		x = document.documentElement.clientWidth-20;
		vx = -vx / bounciness; 
	}
	if (y > document.documentElement.clientHeight-20) {
		y = document.documentElement.clientHeight-20;
		vy = -vy / bounciness; 
	}	
}

window.onload = init;

</script>

</body>
</html>
